<!-- Evita que el click dentro del modal burbujee al overlay -->
<div class="overlay" *ngIf="open" (click)="close.emit()"></div>

<div class="modal" *ngIf="open" role="dialog" aria-modal="true" aria-labelledby="loginTitle"
     (click)="$event.stopPropagation()">
  <div class="panel">
    <header class="head">
      <h2 id="loginTitle">Iniciar sesiÃ³n</h2>
      <button class="close" (click)="close.emit()" aria-label="Cerrar">Ã—</button>
    </header>

    <div class="body">
      <form class="form" [formGroup]="form" (ngSubmit)="submit()">
        <label>
          Correo electrÃ³nico
          <input type="email" formControlName="email" placeholder="tucorreo@dominio.com">
          <small class="hint error" *ngIf="form.get('email')?.touched && form.get('email')?.invalid">
            Ingresa un correo vÃ¡lido.
          </small>
        </label>

        <label>
          ContraseÃ±a
          <div class="pwd">
            <input [type]="hide ? 'password':'text'" formControlName="password" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢">
            <button type="button" class="eye" (click)="hide=!hide" aria-label="Mostrar/ocultar">ğŸ‘</button>
          </div>
          <small class="hint error" *ngIf="form.get('password')?.touched && form.get('password')?.invalid">
            La contraseÃ±a debe tener al menos 6 caracteres.
          </small>
        </label>

        <a class="link" href="#">Â¿Olvidaste tu contraseÃ±a?</a>

        <!-- Forzamos tambiÃ©n (click) por si el ngSubmit no disparaba -->
        <button class="btn btn-primary wfull"
                type="submit"
                (click)="submit()"
                [disabled]="loading || form.invalid">
          <span *ngIf="!loading">Iniciar sesiÃ³n</span>
          <span *ngIf="loading">Entrandoâ€¦</span>
        </button>
      </form>

      <div class="or"><span>o</span></div>

      <button class="btn btn-google wfull" type="button" (click)="loginWithGoogle()" [disabled]="loading">
        <span class="g">G</span> Continuar con Google
      </button>

      <button type="button" class="link" (click)="goRegister.emit()" [disabled]="loading">
        Registrarse
      </button>

      <p class="error" *ngIf="errorMsg">{{ errorMsg }}</p>
    </div>
  </div>
</div>
