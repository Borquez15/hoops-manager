<!-- src/app/features/tournament-detail/tournament-detail.component.html -->
<div class="page-container">
  
  <!-- ========== LOADING ========== -->
  <div *ngIf="loading" class="loading-container">
    <div class="spinner"></div>
    <p>Cargando torneo...</p>
  </div>

  <!-- ========== ERROR ========== -->
  <div *ngIf="error && !loading" class="error-alert">
    <h2>âš ï¸ Error</h2>
    <p>{{ error }}</p>
    <button (click)="goBack()" class="btn-back">Volver a Mis Torneos</button>
  </div>

  <!-- ========== CONTENIDO PRINCIPAL ========== -->
  <div *ngIf="!loading && !error && tournament" class="content">
    
    <!-- HEADER -->
    <div class="page-header">
      <button class="back-btn" (click)="goBack()">
        â† Volver
      </button>
      
      <div class="header-info">
        <h1 class="page-title">MI TORNEO - {{ tournament.nombre }}</h1>
        <span class="status-badge" [ngClass]="getStatusBadge().class">
          {{ getStatusBadge().text }}
        </span>
      </div>

      <!-- BotÃ³n Iniciar Torneo (solo si el calendario estÃ¡ generado) -->
      <button 
        *ngIf="canStartTournament()" 
        class="start-tournament-btn"
        (click)="startTournament()"
      >
        ğŸš€ Iniciar Torneo
      </button>
    </div>

    <!-- ========== GRID DE 4 TARJETAS (2x2) ========== -->
    <div class="sections-grid">
      
      <!-- ========================================
           TARJETA 1: CONFIGURACIÃ“N
           ======================================== -->
      <div class="section-card">
        <div class="section-header">
          <h2>ConfiguraciÃ³n</h2>
        </div>
        
        <div class="section-body">
          <!-- Modo visualizaciÃ³n -->
          <div *ngIf="!editMode">
            <div class="config-item">
              <span class="label">Nombre de la liga:</span>
              <span class="value">{{ tournament.nombre }}</span>
            </div>
            <div class="config-item">
              <span class="label">Vueltas a jugar:</span>
              <span class="value">{{ tournament.vueltas }}</span>
            </div>
            <div class="config-item">
              <span class="label">Clasifican de playoff:</span>
              <span class="value">{{ tournament.cupos_playoffs }}</span>
            </div>
            <div class="config-item">
              <span class="label">Modalidad de juego:</span>
              <span class="value">{{ tournament.modalidad }}</span>
            </div>
            <div class="config-item">
              <span class="label">Cantidad de partidos semanales:</span>
              <span class="value">{{ tournament.partidos_por_dia }}</span>
            </div>
          </div>

          <!-- Modo ediciÃ³n -->
          <div *ngIf="editMode" class="edit-form">
            <div class="form-group">
              <label>Nombre de la liga</label>
              <input type="text" [(ngModel)]="editForm.nombre" class="form-control" placeholder="Nombre...">
            </div>

            <div class="form-row">
              <div class="form-group">
                <label>Vueltas a jugar</label>
                <input type="number" [(ngModel)]="editForm.vueltas" class="form-control" min="1">
              </div>

              <div class="form-group">
                <label>Clasifican de playoff</label>
                <input type="number" [(ngModel)]="editForm.cupos_playoffs" class="form-control" min="0">
              </div>
            </div>

            <div class="form-group">
              <label>Modalidad de juego</label>
              <select [(ngModel)]="editForm.modalidad" class="form-control">
                <option value="3vs3">3 vs 3</option>
                <option value="5vs5">5 vs 5</option>
                <option value="7vs7">7 vs 7</option>
                <option value="11vs11">11 vs 11</option>
              </select>
            </div>

            <div class="form-group">
              <label>Cantidad de partidos semanales</label>
              <input type="number" [(ngModel)]="editForm.partidos_por_dia" class="form-control" min="1">
            </div>

            <div class="form-actions">
              <button class="btn-secondary" (click)="cancelEdit()">Cancelar</button>
              <button class="btn-primary" (click)="saveConfig()">Guardar</button>
            </div>
          </div>
        </div>

        <!-- BotÃ³n editar circular (solo si no estÃ¡ en modo ediciÃ³n) -->
        <button 
          *ngIf="!editMode && tournamentStatus === 'configurando'" 
          class="edit-btn-circle"
          (click)="enableEditMode()"
          title="Editar configuraciÃ³n"
        >
          âœï¸
        </button>
      </div>

      <!-- ========================================
           TARJETA 2: ÃRBITROS (Opcional)
           ======================================== -->
      <div class="section-card">
        <div class="section-header">
          <h2>Ãrbitros</h2>
        </div>
        
        <div class="section-body">
          <div class="empty-state">
            <div class="empty-state-icon">ğŸ‘¨â€âš–ï¸</div>
            <p>PrÃ³ximamente</p>
            <p class="subtitle">PodrÃ¡s agregar Ã¡rbitros para el torneo</p>
          </div>
        </div>
      </div>

      <!-- ========================================
           TARJETA 3: EQUIPOS
           ======================================== -->
      <div class="section-card">
        <div class="section-header">
          <h2>Equipos</h2>
        </div>
        
        <div class="section-body">
          <!-- Formulario agregar equipo -->
          <div *ngIf="showAddEquipoForm" class="add-form">
            <div class="form-group">
              <label>Nombre del Equipo *</label>
              <input 
                type="text" 
                [(ngModel)]="newEquipo.nombre" 
                class="form-control"
                placeholder="Ej: Dallas Mavericks"
              >
            </div>
            <div class="form-group">
              <label>Logo URL (opcional)</label>
              <input 
                type="text" 
                [(ngModel)]="newEquipo.logo" 
                class="form-control"
                placeholder="https://..."
              >
            </div>
            <div class="form-actions">
              <button class="btn-secondary" (click)="toggleAddEquipoForm()">Cancelar</button>
              <button class="btn-primary" (click)="addEquipo()">Agregar</button>
            </div>
          </div>

          <!-- Lista de equipos -->
          <div *ngIf="equipos.length === 0 && !showAddEquipoForm" class="empty-state">
            <div class="empty-state-icon">ğŸ‘¥</div>
            <p>No hay equipos agregados</p>
            <p class="subtitle">Agrega al menos 2 equipos para generar el calendario</p>
          </div>

          <div *ngIf="equipos.length > 0 && !showAddEquipoForm">
            <div *ngFor="let equipo of equipos" class="team-item">
              <div class="team-info">
                <img 
                  *ngIf="equipo.logo_url" 
                  [src]="equipo.logo_url" 
                  [alt]="equipo.nombre"
                  class="team-logo"
                  (error)="$any($event.target).style.display='none'"
                >
                <div class="team-icon" *ngIf="!equipo.logo_url">ğŸ€</div>
                <span class="team-name">{{ equipo.nombre }}</span>
              </div>
              <button 
                *ngIf="tournamentStatus === 'configurando'"
                class="delete-team-btn" 
                (click)="deleteEquipo(equipo.id_equipo)"
                title="Eliminar equipo"
              >
                ğŸ—‘ï¸
              </button>
            </div>
          </div>
        </div>

        <!-- BotÃ³n agregar circular -->
        <button 
          *ngIf="!showAddEquipoForm && tournamentStatus === 'configurando'" 
          class="add-btn-circle"
          (click)="toggleAddEquipoForm()"
          title="Agregar equipo"
        >
          +
        </button>
      </div>

      <!-- ========================================
           TARJETA 4: CALENDARIO
           ======================================== -->
      <div class="section-card">
        <div class="section-header">
          <h2>Calendario</h2>
        </div>
        
        <div class="section-body">
          <!-- CASO 1: No hay equipos suficientes -->
          <div *ngIf="equipos.length < 2" class="calendar-placeholder">
            <div class="calendar-icon">ğŸ“…</div>
            <h3 class="calendar-title">Calendario no disponible</h3>
            <p class="calendar-subtitle">Agrega al menos 2 equipos en la secciÃ³n "Equipos" para poder generar el calendario</p>
          </div>

          <!-- CASO 2: Hay equipos pero calendario no generado -->
          <div *ngIf="equipos.length >= 2 && !calendarGenerated && tournamentStatus === 'configurando'" class="calendar-placeholder">
            <div class="calendar-icon">ğŸ“…</div>
            <h3 class="calendar-title">Â¿Listo para generar el calendario?</h3>
            <p class="calendar-subtitle">
              Una vez que termines de configurar tu torneo y agregar todos los equipos, 
              genera el calendario automÃ¡tico.
            </p>
            <p class="calendar-subtitle" style="margin-top: 1rem; color: #FF7F00; font-weight: 600;">
              ğŸ’¡ PodrÃ¡s revisar y modificar las fechas antes de iniciar el torneo
            </p>
            <button 
              class="generate-calendar-btn"
              (click)="generateCalendar()"
            >
              ğŸ—“ï¸ Generar Calendario
            </button>
          </div>

          <!-- CASO 3: Calendario generado -->
          <div *ngIf="calendarGenerated" class="calendar-placeholder">
            <div class="calendar-icon">âœ…</div>
            <h3 class="calendar-title">Calendario Generado</h3>
            <p class="calendar-subtitle">El calendario ha sido generado exitosamente</p>
            <p class="calendar-subtitle" style="margin-top: 1rem;">
              ğŸ“‹ AquÃ­ aparecerÃ¡ el calendario completo con todos los partidos
            </p>
            <!-- TODO: AquÃ­ irÃ¡ el componente del calendario real -->
          </div>

          <!-- CASO 4: Torneo ya iniciado -->
          <div *ngIf="tournamentStatus !== 'configurando'" class="calendar-placeholder">
            <div class="calendar-icon">ğŸ€</div>
            <h3 class="calendar-title">Torneo {{ tournamentStatus === 'iniciado' ? 'en Curso' : 'Finalizado' }}</h3>
            <p class="calendar-subtitle">Calendario activo</p>
            <!-- TODO: AquÃ­ irÃ¡ el componente del calendario real -->
          </div>
        </div>

        <!-- BotÃ³n editar calendario (solo si estÃ¡ generado y no iniciado) -->
        <button 
          *ngIf="calendarGenerated && tournamentStatus === 'configurando'" 
          class="edit-btn-circle"
          (click)="editCalendar()"
          title="Editar calendario"
        >
          âœï¸
        </button>
      </div>

    </div>
  </div>

</div>